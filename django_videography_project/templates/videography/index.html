{% extends 'videography/main.html' %}

<!--% load crispy_forms_tags % -->

{% block content %}
    <div id = spinner1 class="container text-center no-display text-primary">
        <br>
        <br>
        <div class="spinner-border align-middle" role="status">
            <span class="visually-hidden">Loading...</span>
        </div>
    </div>
        
    <div id='index-body'>
        <div class="form-group">
            <form action="/videography/" method="post" onsubmit="submittionFunciton()">
                {% csrf_token %}
                <div class='container col-md-6'>
                    <br>
                    <h3>Complete the form below:</h3>
                    <div>
                        {% if error != None %}
                            <br>
                            <p id=errorid class="text-danger">Error: {{error}}. Please Try Again.</p>
                        {% endif %} 
                        {% if message != None %}
                            <br>
                            <p id=messageid class="text-success">Submittion complete. Thank you for providing feedback.</p>
                        {% endif %}
                    </div> 
                    <div id=radiodiv>
                        <div class="form-check">
                            <input class="form-check-input" type="radio" name="operation" id="flexRadioDefault2" onclick="radioFunc('music')" value="music" checked>
                            <label class="form-check-label" for="flexRadioDefault4">
                                Alignment Tool (Music)
                            </label>
                        </div>
                        <div class="form-check">
                            <input class="form-check-input" type="radio" name="operation" id="flexRadioDefault1" onclick="radioFunc('captions')" value="captions">
                            <label class="form-check-label" for="flexRadioDefault1">
                                YouTube Captions
                            </label>
                        </div>
                        <div class="form-check">
                            <input class="form-check-input" type="radio" name="operation" id="flexRadioDefault2" onclick="radioFunc('lyrics')" value="lyrics">
                            <label class="form-check-label" for="flexRadioDefault2">
                                Lyric Video Analysis
                            </label>
                        </div>
                        <div class="form-check">
                            <input class="form-check-input" type="radio" name="operation" id="flexRadioDefault2" onclick="radioFunc('spoken')" value="spoken">
                            <label class="form-check-label" for="flexRadioDefault3">
                                Speech Recognition (Spoken-word)
                            </label>
                        </div>
                    </div>
                    <br>
                    <div id=formid>
                        <div id=linkId>
                            {{ link_form.as_p }}
                        </div>
                        <div id=artistId>
                            {{ artist_form.as_p }}
                        </div>
                    </div>
                    <input type="submit" value="Submit" id='button1'>
                </div>
            </form>
            
        </div>
    </div>

    <script>

    const spinner = document.getElementById('spinner1');
    const navigationBar = document.getElementById('nav');
    const index = document.getElementById('index-body');

    function unloadFunction(){
        index.classList.remove('no-display')
        navigationBar.classList.remove('no-display')
        spinner.classList.add('no-display')

        formDiv.innerHTML = ""
        formDiv.innerHTML = link_html

        radiodiv.innerHTML = ""
        radiodiv.innerHTML = radio_temp
    }




    var formType = 'link';

    const artist_html = document.getElementById('artistId').innerHTML;
    const link_html = document.getElementById('linkId').innerHTML;

    document.getElementById('artistId').remove();
    document.getElementById('linkId').remove();

    const formDiv = document.getElementById('formid');
    formDiv.innerHTML = artist_html;

    const radio_temp = document.getElementById('radiodiv');

    const error = document.getElementById('errorid')
    if (error != null){
        const myTimeout = setTimeout(function(){
            error.remove()
        }, 5000);
    };

    function submittionFunciton(){
        index.classList.add('no-display')
        navigationBar.classList.add('no-display')
        spinner.classList.remove('no-display')
    }

    function radioFunc(name){

        const artist = document.getElementById('artistId')
        const link = document.getElementById('linkId')

        if (name == 'captions' || name == 'spoken'){
            formDiv.innerHTML = link_html
            
            formType = 'list'
            
        }else if (name == 'lyrics' || name == 'music'){
            formDiv.innerHTML = artist_html

            formType = 'artist'
        }
    };

    const message = document.getElementById('messageid')
    if (message != null){
        const myTimeout = setTimeout(function(){
            message.remove()
        }, 5000);
    };
    
    </script>

{% endblock content %}
